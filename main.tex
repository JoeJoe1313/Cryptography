\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[document]{ragged2e}
\usepackage[dvipsnames]{xcolor}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{amssymb, graphics, setspace}
\usepackage{multicol}

\title{ЗАДАЧИ ПО КРИПТОГРАФИЯ}
\author{Йоана Левчева\\ Приложна математика, 4 курс, ф.н. 31492}

\begin{document}

\maketitle

\section*{Задача 1}
\justify

Ще започнем, разбивайки по двойки букви открития текст и съответстващия му криптотекст:

\begin{center}
\begin{tabular}{ c c c c c c c c c c c c }

 TH & EW & IN & TE & RO & FO & UR & DI & SC & ON & TE & NT \\ 
 WG & NZ & DZ & WN & IS & OS & BH & GR & RE & AZ & WN & TW    

\end{tabular}
\end{center}

\justify
Сега, ако разгледаме двойката NT $\rightarrow$ TW, става ясно, че NTW се намират на един ред или на един стълб. От TE $\rightarrow$ WN, тъй като NTW се намират на един ред или на един стълб, това означава, че ENTW се намират на един ред или на един стълб. От EW $\rightarrow$ NZ, тъй като ENW се намират на един ред или на един стълб, излиза, че ENTWZ се намират на един ред или на сълб. Нека приемем, че се намират на един ред и ги поставим в първия ред на таблицата ни 5x5, представляваща ключа, за която сме приели, че J ще съвпада с I. В реда ENTWZ се изпълняват условията на трите, разгледани досега двойки букви. Ключът придобива следния вид:

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
        \hline
        E & N & T & W & Z \\
        \hline
         &  &  &  &  \\
        \hline
         &  &  &  &  \\
        \hline
         &  &  &  &  \\
        \hline
         &  &  &  &  \\
        \hline
        \end{tabular}
\end{center}

\justify
От FO $\rightarrow$ OS следва, че FOS също са на един ред или на един стълб, а от ON $\rightarrow$ AZ следва, че те образуват правоъгълник AOZN, като А се намира под N и O се намира под Z. Тъй като Z се намира в края на реда, О е под него и FOS са на един ред (възможността да са на един стълб отпада заради правоъгълника AOZN), то излиза, че S трябва да се намира под E и F се намира под W. Нека попълним втория ред на таблицара, взимайки предвид тези заключения. Получаваме:

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
        \hline
        E & N & T & W & Z \\
        \hline
        S & A &  & F & O \\
        \hline
         &  &  &  &  \\
        \hline
         &  &  &  &  \\
        \hline
         &  &  &  &  \\
        \hline
        \end{tabular}
\end{center}

\justify
Сега от TH $\rightarrow$ WG се образува правоъгълник TWHG и следователно H се намира под W и G се намира под T. Нека ги поставим на третия ред от таблицата. IN $\rightarrow$ DZ също образува правоъгълник IDNZ и следователно I се намира под Z и D се намира под N. От DI $\rightarrow$ GR следва, че DGIR се намират на един ред, откъдето следва, че на третия ред се намират RDGHI. За R остава да се намира под S. Ключът вече има следния вид: 

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
        \hline
        E & N & T & W & Z \\
        \hline
        S & A &  & F & O \\
        \hline
        R & D & G & H & I \\
        \hline
         &  &  &  &  \\
        \hline
         &  &  &  &  \\
        \hline
        \end{tabular}
\end{center}

\justify
От SC $\rightarrow$ RE, тъй като ESR следва, че и C се намира в същия първи стълб и понеже C $\rightarrow$ Е то C се намира на последния ред. Остана да разгледаме само UR $\rightarrow$ BH, при което се образува правоъгълника UBRH, тоест U се намира под H и B се намира под R. Понеже за B има единствена възможност да е на предпоследния ред, то и U излиза, че трябва да се намира на предпоследния ред. Използвайки открититя текст и съответстващия му криптотекст, успяхме да конструираме ключа до следния вид: 

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
        \hline
        E & N & T & W & Z \\
        \hline
        S & A &  & F & O \\
        \hline
        R & D & G & H & I \\
        \hline
        B &  &  & U &  \\
        \hline
        C &  &  &  &  \\
        \hline
        \end{tabular}
\end{center}

\justify
Нека сега разгледаме криптотекста, който трябва да дешифрираме и дешифрираме каквото можем, използвайки отчасти конструрирания ключ: 

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        EB & QX & ZL & HD & LK & IV & QG & OM & AL & EB & VB & DO & SG & SF \\
        \hline
        CR &  &  & GR &  &  &  &  &  & CR &  & IA &  & 0- \\
        \hline
        \end{tabular}
\end{center}

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        ZR & AN & DA & MO & LB & SE & EL & SO & ZL & KD & CO & ZF & GS & IN \\
        \hline
        EI & N- & AN &  &  & EC &  & OF &  &  & -S & WO & R- & DZ \\
        \hline
        \end{tabular}
\end{center}

\justify
Може да предположим, че първата дума от криптотекста е CRYPTOGRAPHY.

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        EB & QX & ZL & HD & LK & IV & QG & OM & AL & EB & VB & DO & SG & SF \\
        \hline
        CR & \textcolor{red}{YP} & \textcolor{red}{TO} & GR & \textcolor{red}{AP} & \textcolor{red}{HY} &  &  &  & CR &  & IA &  & 0- \\
        \hline
        \end{tabular}
\end{center}

\justify
Забелязваме, че ZL $\rightarrow$ TO, тоест се образува правоъгълник ZTLO и мястото на L става известно. А от IV $\rightarrow$ HY от правоъгълника IHVY имаме, че V e под H и Y е под I. Понеже U е точно под H следва, че V и Y се намират на последния ред. Получаваме за ключа:

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
        \hline
        E & N & T & W & Z \\
        \hline
        S & A & \textcolor{red}{L} & F & O \\
        \hline
        R & D & G & H & I \\
        \hline
        B &  &  & U &  \\
        \hline
        C &  &  & \textcolor{red}{V} & \textcolor{red}{Y} \\
        \hline
        \end{tabular}
\end{center}

\justify
Използвайки последния вариант на ключа, се опитваме да дешифрираме още от криптотекста.

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        EB & QX & ZL & HD & LK & IV & QG & OM & AL & EB & VB & DO & SG & SF \\
        \hline
        CR & \textcolor{red}{YP} & \textcolor{red}{TO} & GR & \textcolor{red}{AP} & \textcolor{red}{HY} &  &  & \textcolor{blue}{SA} & CR & \textcolor{blue}{UC} & IA & \textcolor{blue}{LR} & 0\textcolor{blue}{L} \\
        \hline
        \end{tabular}
\end{center}

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        ZR & AN & DA & MO & LB & SE & EL & SO & ZL & KD & CO & ZF & GS & IN \\
        \hline
        EI & N- & AN &  & \textcolor{blue}{S}- & EC & \textcolor{blue}{TS} & OF & \textcolor{blue}{TO} &  & \textcolor{blue}{Y}S & WO & R\textcolor{blue}{L} & DZ \\
        \hline
        \end{tabular}
\end{center}

\justify
От QX $\rightarrow$ YP имаме, че Q е на последния ред, а P и X на предпоследния, по-конкретно X e над Y. От LK $\rightarrow$ AP щом P е на предпоследния ред следва, че и К е на предпоследния ред, като K е под D и P e под X. Следователно Q е на последния ред под P. И остава М да е под K. Вече разпоалагме с целия ключ: 

\begin{center}
\begin{tabular}{|c|c|c|c|c|}
        \hline
        E & N & T & W & Z \\
        \hline
        S & A & \textcolor{red}{L} & F & O \\
        \hline
        R & D & G & H & I \\
        \hline
        B & \textcolor{blue}{K} & \textcolor{blue}{P} & U & \textcolor{blue}{X} \\
        \hline
        C & \textcolor{blue}{M} & \textcolor{blue}{Q} & \textcolor{red}{V} & \textcolor{red}{Y} \\
        \hline
        \end{tabular}
\end{center}

\justify
Разполагайки с ключа, можем да дешифрираме целия криптотекст:

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        EB & QX & ZL & HD & LK & IV & QG & OM & AL & EB & BV & DO & SG & SF \\
        \hline
        CR & \textcolor{red}{YP} & \textcolor{red}{TO} & GR & \textcolor{red}{AP} & \textcolor{red}{HY} & \textcolor{olive}{PL} & \textcolor{olive}{AY} & \textcolor{blue}{SA} & CR & \textcolor{blue}{UC} & IA & \textcolor{blue}{LR} & 0\textcolor{blue}{L} \\
        \hline
        \end{tabular}
\end{center}

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        ZR & AN & DA & MO & LB & SE & EL & SO & ZL & KD & CO & ZF & GS & IN \\
        \hline
        EI & N\textcolor{olive}{M} & AN & \textcolor{olive}{YA} & \textcolor{blue}{S}\textcolor{olive}{P} & EC & \textcolor{blue}{TS} & OF & \textcolor{blue}{TO} & \textcolor{olive}{DA} & \textcolor{blue}{Y}S & WO & R\textcolor{blue}{L} & DZ \\
        \hline
        \end{tabular}
\end{center}

\justify
Z в края на изрчението играе роля на доплъваща буква до четен брой букви на изречението без да променя смисъла на думата. Окончателно криптотекстът се дешифрира като: \\

\justify
CRYPTOGRAPHY PLAYS A CRUCIAL ROLE IN MANY ASPECTS OF TODAY'S WORLD

\section*{Задача 2}

\justify
Първо ще отбележим, че $\mathbf{Z_{26}}$ $\simeq$ $\mathbf{Z_2}$ $\times$ $\mathbf{Z_{13}}$. Нека разгледаме матрицата $K$ = $\begin{pmatrix}
                             a & b \\
                             c & d
                         \end{pmatrix}$
                         $\in$ $\mathbf{Z_{13}}$. 
По условие $K = K^{-1}$. Следователно $KK^{-1} = KK = K^2 = I$. Това е еквивалентно на следната система: 

\begin{center}
\begin{tabular}{ c }

 $a^2 + bc = 1$ \\ 
 $b(a + d) = 0$ \\
 $c(a + d) = 0$ \\
 $d^2 + bc = 1$
 
\end{tabular}
\end{center}

\justify
Ако $a + d \neq 0$ следва, че $b = 0$ и $c = 0$ и също $a^2 = 1$ и $d^2 = 1$. От тук получаваме две решения. \\
\\Сега, ако $a + d = 0$, имаме следните случаи:

$\bullet$ $a = 0$. Тогава $bc = 1$, което означава, че $b$ и $c$ са обратими и следователно имаме $13 - 1 = 12$ още $12$ решения, защото в $\mathbf{Z_{13}}$ има 12 обратими елемента.

$\bullet$ $a = 1$. Тогава $bc = 0$, т.е. имаме още 2*13 - 1 = 25 решения.

$\bullet$ $a = -1$. Аналогично, $bc = 0$ и имаме още 2*13 -1 = 25 решения.

$\bullet$ $a \neq 0, 1, -1$. Тогава $c$ = $(1 - a^2)b^{-1}$. Това ни дава още $(13-1)(13-3) = 120$ решения.

\justify
Сумирайки всички решения, получаваме, че в $\mathbf{Z_{13}}$ има $2 + 12 + 25 + 25 + 120 = 184$ решения.

\justify
Остава да преброим матриците с това свойство над $\mathbf{Z_2}$. Аналогично, нека разгледаме матрицата $K$ = $\begin{pmatrix}
                             a & b \\
                             c & d
                         \end{pmatrix}$
                         $\in$ $\mathbf{Z_{2}}$. 
Отново получаваме същата система като при $\mathbf{Z_{13}}$.

\justify
Ако $a + d \neq 0$ следва, че $b = 0$ и $c = 0$ и също, че или $a = 1$ или $d = 1$. Но от $b = 0$ и $c = 0$ следва, че и $a^2 = 1$ и $d^2 = 1$, т.е. $a = 1$ и $d = 1$, което е невъзможно. Следователно от тук получаваме 0 решения. \\
\\Сега, ако $a + d = 0$, имаме следните случаи: 

$\bullet$ $a = 0$. Тогава следва, че $d = 0$ и $bc = 1$, което означава, че $b$ и $c$ са обратими и следователно имаме една взъможност $b = 1$ и $c = 1$. Този случай ни дава 1 решение.

$\bullet$ $a = 1$. Тогава и $d = 1$ и още $bc = 0$, т.е. или $b = 0$, $c = 1$ или $c = 0$, $b = 1$ или $b = c = 0$. От тук имаме още 3 решения.

\justify
Сумирайки всички решения, получаваме, че в $\mathbf{Z_{2}}$ има $1 + 3 = 4$ решения.

\justify
Тъй като $\mathbf{Z_{26}}$ $\simeq$ $\mathbf{Z_2}$ $\times$ $\mathbf{Z_{13}}$, то над $\mathbf{Z_{26}}$ има 4*184 = 736 матрици със свойство $K = K^{-1}$.

\section*{Задача 3}

\justify
Ще започнем с това да преобразуваме открития текст и съответстващия му криптотекст във вектори над $\mathbf{Z_{26}}$, използвайки дадената схема за кодиране:

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        C & R & Y & P & T & O & G & R & A & P & H & Y \\
        \hline
        2 & 17 & 24 & 15 & 19 & 14 & 6 & 17 & 0 & 15 & 7 & 24 \\
        \hline
        \end{tabular}
\end{center}

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|}
        \hline
        V & G & Y & X & A & R & D & I & G & L & M & L \\
        \hline
        21 & 6 & 24 & 23 & 0 & 17 & 3 & 8 & 6 & 11 & 12 & 11 \\
        \hline
        \end{tabular}
\end{center}

\justify
Дължината на шифрираното съобщение е 12. Тъй като $m$ не е известно и сме предположили, че дели дължината на шифрираното съобщение, то ще започнем от случая $m = 2$. 

\justify
Тъй като $m = 2$, то ще разбием открития текст и криптотекста на 6 блока с дължина 2. Имаме следните двойки: $E_K(2,17) = (21,6)$, $E_K(24,15) = (24,23)$, $E_K(19,14) = (0,17)$, $E_K(6,17) = (3,8)$, $E_K(0,15) = (6,11)$, $E_K(7,24) = (12,11)$. От първата и третата двойка получаваме следното матрично уравнение: \\

\begin{center}
$\begin{pmatrix}
    21 & 6 \\
    0 & 17
\end{pmatrix}$ = $\begin{pmatrix}
                             2 & 17 \\
                             19 & 14
                         \end{pmatrix}$ $K$
\end{center}

\justify
Пресмятаме $\begin{pmatrix}
                2 & 17 \\
                19 & 14
            \end{pmatrix}^{-1}$ = $\begin{pmatrix}
                10 & 25 \\
                5 & 20
            \end{pmatrix}$. Тогава за ключа получаваме: \\
            
\begin{center}
    $K$ = $\begin{pmatrix}
                10 & 25 \\
                5 & 20
            \end{pmatrix}$ $\begin{pmatrix}
                21 & 6 \\
                0 & 17
            \end{pmatrix}$ = $\begin{pmatrix}
                16 & 15 \\
                9 & 14
            \end{pmatrix}$
\end{center}

\justify
Сега да приложим ключа (също така $K^{-1}$ съществува) към втората двойка от открития текст:

\begin{center}
    $(24,15)$ $\begin{pmatrix}
                16 & 15 \\
                9 & 14
            \end{pmatrix}$ = $(25,24)$,
\end{center}

\justify
което очевидно не е вярно, защото трябваше да получим $(24,23)$. Следователно, ако $m = 2$, не можем да намерим ключа. 

\justify
Нека сега $m = 3$. Трябва да разбием открития текст и криптотекста на 4 блока с дължина 3. Имаме следните тройки: $E_K(2,17,24) = (21,6,24)$, $E_K(15,19,14) = (23,0,17)$, $E_K(6,17,0) = (3,8,6)$, $E_K(15,7,24) = (11,12,11)$. Трябва да решим следната система: 

\begin{center}
    $\begin{pmatrix}
        2 & 17 & 24 \\
        15 & 19 & 14 \\
        6 & 17 & 0 \\
        15 & 7 & 24
    \end{pmatrix}$ $K$ = $\begin{pmatrix}
                            21 & 6 & 24 \\
                            23 & 0 & 17 \\
                            3 & 8 & 6 \\
                            11 & 12 & 11
                         \end{pmatrix}$
\end{center}

\justify
След известен брой аритметични операции стигаме до решението:

\begin{center}
    $K$ = $\begin{pmatrix}
        2 & 0 & 1 \\
        1 & 2 & 0 \\
        0 & 1 & 2
    \end{pmatrix}$
\end{center}

\justify
Матрицата $K$ също така е и обратима: 

\begin{center}
    $K^{-1}$ = $\begin{pmatrix}
        12 & 3 & 20 \\
        20 & 12 & 3 \\
        3 & 20 & 12
    \end{pmatrix}$
\end{center}

\justify
Следователно матрицата $K$ удовлетворява условието да е ключ. 

\justify
Код на Wolfram Mathematica за случая $m = 3:$
\begin{verbatim}
    plainText = {{2,17,24},{15,19,14},{6,17,0},{15,7,24}};
    cryptoText = {{21,6,24},{23,0,17},{3,8,6},{11,12,11}};
    xMatrix = {{x1,x2,x3},{x4,x5,x6},{x7,x8,x9}};

    Solve[plainText.xMatrix==cryptoText,{x1,x2,x3,x4,x5,x6,x7,x8,x9}, Modulus->26]
    {{x1->2,x2->0,x3->1,x4->1,x5->2,x6->0,x7->13 C[1],x8->1+13 C[2],x9->2+13 C[3]}}

    Dimensions[{{x1->2,x2->0,x3->1,x4->1,x5->2,x6->0,x7->13 C[1],
    x8->1+13C[2],x9->2+13 C[3]}}]
    {1,9}

    K = {{2,0,1},{1,2,0},{0,1,2}}
    {{2,0,1},{1,2,0},{0,1,2}}

    invK =Inverse[{{2,0,1},{1,2,0},{0,1,2}},Modulus->26]
    {{12,3,20},{20,12,3},{3,20,12}}

    Mod[cryptoText.{{12,3,20},{20,12,3},{3,20,12}},26]
    {{2,17,24},{15,19,14},{6,17,0},{15,7,24}}
\end{verbatim}

\section*{Задача 4}

\justify
Откритият текст ще има дължина равна на дължината на криптотекста, тоест 31, и в себе си съдържа думата GESTURE. Имаме например:

\begin{center}
\begin{tabular}{c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c}
        * * * * * * * * * * * * * * G E S T U R E * * * * * * * * * * \\
        \end{tabular}
\end{center}

\justify
Ключът се състои от ключовата дума, поставена в началото, и открития текст поставен веднага след нея. Тъй като по условие ключовата дума е с дължина 6, то ще има изместване на GESTURE с 6 позиции надясно:

\begin{center}
\begin{tabular}{c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c c}
        $k0$ $k1$ $k2$ $k3$ $k4$ $k5$ * * * * * * * * * * * * * * G E S T U R E * * * * \\
        \end{tabular}
\end{center}

\justify
Забелязваме, че тъй като GESTURE има дължина 7, а отместването е с дължина 6, то G в ключа ще стои под E в открития текст. Също така при шифриране това означава, че имаме $E + G = K$, което показва, че GESTURE в ключа, може да се постави, така че да e над $K$ в криптотекста. В криптотрекста имаме $K$ на точно 5 места, тоест има 5 възможности. След проверяване на случаите, само един излиза, че може да е смислен и нека дешифрираме каквото можем, използвайки тази информация:

\justify
Криптотекст:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    G&X&I&L&B&G&L&Q&Q&J&A&I&P&W&B&M&R&K&A&Z&B&W&Y&K&K&K&U&C&R&K&G \\
    \hline
    6&23&8&11&1&6&11&16&16&9&0&8&15&22&1&12&17&10&0&25&1&22&24&10&10&10&20&2&17&10&6 \\
    \hline
\end{tabular}}
\end{center}

\justify
Ключ:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    -&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&G&E&S&T&U&R&E&-&-&-&-&-&-&- \\
    \hline
    -&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&6&4&18&19&20&17&4&-&-&-&-&-&-&- \\
    \hline
\end{tabular}}
\end{center}

\justify
Открит текст:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    -&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&4&22&7&8&2&7&6&-&-&-&-&-&-&- \\
    \hline
    -&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&E&W&H&I&C&H&G&-&-&-&-&-&-&- \\
    \hline
\end{tabular}}
\end{center}

\justify
Разполагайки с тази информация, вече знаем, че в ключа вдясно от GESTURE се намира WHICHG, а в открития текст отляво на EWHICH имаме GESTUR. И нека отново разкирем колкото можем информация за ключа и открития текст.

\justify
Криптотекст:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    G&X&I&L&B&G&L&Q&Q&J&A&I&P&W&B&M&R&K&A&Z&B&W&Y&K&K&K&U&C&R&K&G \\
    \hline
    6&23&8&11&1&6&11&16&16&9&0&8&15&22&1&12&17&10&0&25&1&22&24&10&10&10&20&2&17&10&6 \\
    \hline
\end{tabular}}
\end{center}

\justify
Ключ:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    -&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&G&E&S&T&U&R&E&\textcolor{red}{W}&\textcolor{red}{H}&\textcolor{red}{I}&\textcolor{red}{C}&\textcolor{red}{H}&\textcolor{red}{G}&- \\
    \hline
    -&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&-&6&4&18&19&20&17&4&\textcolor{red}{22}&\textcolor{red}{7}&\textcolor{red}{8}&\textcolor{red}{2}&\textcolor{red}{7}&\textcolor{red}{6}&- \\
    \hline
\end{tabular}}
\end{center}

\justify
Открит текст:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    -&-&-&-&-&-&-&-&-&-&-&\textcolor{red}{6}&\textcolor{red}{4}&\textcolor{red}{18}&\textcolor{red}{19}&\textcolor{red}{20}&\textcolor{red}{17}&4&22&7&8&2&7&6&-&-&-&-&-&-&- \\
    \hline
    -&-&-&-&-&-&-&-&-&-&-&\textcolor{red}{G}&\textcolor{red}{E}&\textcolor{red}{S}&\textcolor{red}{T}&\textcolor{red}{U}&\textcolor{red}{R}&E&W&H&I&C&H&G&-&-&-&-&-&-&- \\
    \hline
\end{tabular}}
\end{center}

\justify
По аналогичен начин успяваме да открием открития текст:

\justify
Криптотекст:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    G&X&I&L&B&G&L&Q&Q&J&A&I&P&W&B&M&R&K&A&Z&B&W&Y&K&K&K&U&C&R&K&G \\
    \hline
    6&23&8&11&1&6&11&16&16&9&0&8&15&22&1&12&17&10&0&25&1&22&24&10&10&10&20&2&17&10&6 \\
    \hline
\end{tabular}}
\end{center}

\justify
Ключ:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    \textcolor{orange}{G}&\textcolor{orange}{L}&\textcolor{orange}{A}&\textcolor{orange}{U}&\textcolor{orange}{B}&\textcolor{olive}{E}&\textcolor{olive}{A}&\textcolor{olive}{M}&\textcolor{olive}{I}&\textcolor{olive}{R}&\textcolor{olive}{A}&\textcolor{blue}{C}&\textcolor{blue}{L}&\textcolor{blue}{E}&\textcolor{blue}{I}&\textcolor{blue}{S}&\textcolor{blue}{A}&G&E&S&T&U&R&E&\textcolor{red}{W}&\textcolor{red}{H}&\textcolor{red}{I}&\textcolor{red}{C}&\textcolor{red}{H}&\textcolor{red}{G}&\textcolor{blue}{O} \\
    \hline
    \textcolor{orange}{6}&\textcolor{orange}{11}&\textcolor{orange}{0}&\textcolor{orange}{20}&\textcolor{orange}{1}&\textcolor{olive}{4}&\textcolor{olive}{0}&\textcolor{olive}{12}&\textcolor{olive}{8}&\textcolor{olive}{17}&\textcolor{olive}{0}&\textcolor{blue}{2}&\textcolor{blue}{11}&\textcolor{blue}{4}&\textcolor{blue}{8}&\textcolor{blue}{18}&\textcolor{blue}{0}&6&4&18&19&20&17&4&\textcolor{red}{22}&\textcolor{red}{7}&\textcolor{red}{8}&\textcolor{red}{2}&\textcolor{red}{7}&\textcolor{red}{6}&\textcolor{blue}{14} \\
    \hline
\end{tabular}}
\end{center}

\justify
Открит текст:
\begin{center}
\resizebox{\textwidth}{!}{\begin{tabular}{|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|c|}
    \hline
    \textcolor{olive}{0}&\textcolor{olive}{12}&\textcolor{olive}{8}&\textcolor{olive}{17}&\textcolor{olive}{0}&\textcolor{blue}{2}&\textcolor{blue}{11}&\textcolor{blue}{4}&\textcolor{blue}{8}&\textcolor{blue}{18}&\textcolor{blue}{0}&\textcolor{red}{6}&\textcolor{red}{4}&\textcolor{red}{18}&\textcolor{red}{19}&\textcolor{red}{20}&\textcolor{red}{17}&4&22&7&8&2&7&6&\textcolor{blue}{14}&\textcolor{blue}{3}&\textcolor{blue}{12}&\textcolor{blue}{0}&\textcolor{blue}{10}&\textcolor{blue}{4}&\textcolor{olive}{18} \\
    \hline
    \textcolor{olive}{A}&\textcolor{olive}{M}&\textcolor{olive}{I}&\textcolor{olive}{R}&\textcolor{olive}{A}&\textcolor{blue}{C}&\textcolor{blue}{L}&\textcolor{blue}{E}&\textcolor{blue}{I}&\textcolor{blue}{S}&\textcolor{blue}{A}&\textcolor{red}{G}&\textcolor{red}{E}&\textcolor{red}{S}&\textcolor{red}{T}&\textcolor{red}{U}&\textcolor{red}{R}&E&W&H&I&C&H&G&\textcolor{blue}{O}&\textcolor{blue}{D}&\textcolor{blue}{M}&\textcolor{blue}{A}&\textcolor{blue}{K}&\textcolor{blue}{E}&\textcolor{olive}{S} \\
    \hline
\end{tabular}}
\end{center}

\justify
Получихме, че ключовата дума е \\
\begin{center}
    GLAUBE \\
\end{center}
и откритият текст е \\
\begin{center}
    A MIRACLE IS A GESTURE WHICH GOD MAKES.
\end{center}

\section*{Задача 5}

\justify
Имеме криптотекста разделен на групи:
\begin{center}
ACAUI MMGRC AILEE HKREG EAISW OSTHDS
\end{center}
\justify
На първия ред за първата клетка имаме две възможности - да съдържа $A$ или да е забранена, което ще отбелязваме със $*$. За останалите клетки възможностите са да са забранени полета или да съдържат първата или втората буква от своят група. 

\justify
Код на Swift за всички възможни комбинации от букви за  първия ред от таблицата:

\begin{verbatim}
let firstBox: [Character] = ["*", "a"]
let secondBox: [Character] = ["*", "m"]
let thirdBox: [Character] = ["*", "a", "i"]
let fourthBox: [Character] = ["*", "h", "k"]
let fifthBox: [Character] = ["*", "e", "a"]
let sixthBox: [Character] = ["*", "o", "s"]

var myCount: Int

for first in firstBox {
    for second in secondBox {
        for third in thirdBox {
            for fourth in fourthBox {
                for fifth in fifthBox {
                    for sixth in sixthBox {
                        myCount = 0
                        for box in "\(first)\(second)\(third)\(fourth)\(fifth)\(sixth)" {
                            if box == "*" {
                                myCount += 1
                            }
                        }
                        if myCount == 0 || myCount == 1 {
                                print("\(first)\(second)\(third)\(fourth)\(fifth)\(sixth)")
                        }
                    }
                }
            }
        }
    }
}
\end{verbatim}

\justify
Нито една от 80-те различни комбинации не върши работа, ако сме приели, че има най-много по едно забранено поле в колона и ред. Но, взимайки предвид отговора на предишната задача,

\begin{center}
    A MIRACLE IS A GESTURE WHICH GOD MAKES
\end{center}

\justify
можем да конструираме следната таблица, която обаче има една колона с две забранени места: 

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
        \hline
        A & M & I & R & A & * \\
        \hline
        C & * & L & E & I & S \\
        \hline
        A & G & E & * & S & T \\
        \hline
        U & R & E & * & W & H  \\
        \hline
        I & C & H & G & O & D \\
        \hline
        M & A & K & E & * & S \\
        \hline
        \end{tabular}
\end{center}

\section*{Задача 6}

\justify
$x^{21} + 1$ е характеристичен полином на периодична редица с период 21 (тя просто копира елемента 21 позиции назад).
Ако полиномът на друга редица дели този полином, то значи и периодът й ще го дели.
Това означава, че ако намерим полином, който дели този, но не дели $x^3 + 1$ и $x^7 + 1$, тогава
периодът на редицата, която генерира ще дели 21, но няма да дели 3 и няма да дели 7 следователно ще е точно 21.
Полиномът, който ще намерим, трябва да е най-малко от 6та степен, тъй като полином от n-та може да породи редица с
цикъл с дължина най-много $2^{n-1}$, а ние искаме $2^4 < 21 < 2^5$ следователно трябва да е поне от 6-та степен.
Тъй като търсим полином от 6-та степен, имаме, че той никога не дели $x^3 + 1$.
\justify
С този код на $Wolfram$ $Mathematica$ намираме всички полиноми от 6-та степен над $Z2$, които делят $x^{21} + 1$.

\begin{verbatim}
coefficient = {0, 1};

For[first = 1, first <= 2, first++,
 For[second = 1, second <= 2, second++,
  For[third = 1, third <= 2, third++,
   For[fourth = 1, fourth <= 2, fourth++,
    For[fifth = 1, fifth <= 2, fifth++,
     polynomial = 
      1 + coefficient[[first]]*x + coefficient[[second]]*x^2 + 
       coefficient[[third]]*x^3 + coefficient[[fourth]]*x^4 + 
       coefficient[[fifth]]*x^5 + x^6;
     If[PolynomialRemainder[x^21 + 1, polynomial, x, Modulus -> 2] == 
       0, Print[polynomial]]
     ]
    ]
   ]
  ]
 ]
\end{verbatim}

\justify
Резултатът от изпълнението на програмата е:

\begin{center}
$1+x^2+x^5+x^6$ \\
$1+x^2+x^4+x^5+x^6$ \\
$1+x+x^4+x^6$ \\
$1+x+x^2+x^4+x^6$ \\
$1+x+x^2+x^3+x^4+x^5+x^6$
\end{center}

\justify
От полиномите всички, освен последния, не делят $x^7 + 1$, т.е. можем да изберем всеки от първите 4.

\section*{Задача 7}

\justify
В началото имаме блок $A$ с дължина $m = 2$ и блок $B$ с дължина $n = 4$. Искаме да шифрираме 101101 за $h = 4$ стъпки. Тоест имаме, че $A = 10$ и $B = 1101$.

\justify
Стъпка $h = 1$:
\begin{center}
    $A' = 1101$ \\
    $B' = A \oplus f_1(B) = 10 \oplus f_1(1101) = 10 \oplus 00 = 10$
\end{center}
Получаваме 110110.

\justify
Стъпка $h = 2$: \\
Сега имаме, че $A = 11$ и $B = 0110$. Оттук получаваме:
\begin{center}
    $A' = 0110$ \\
    $B' = A \oplus f_2(B) = 11 \oplus f_2(0110) = 11 \oplus 01 = 10$
\end{center}
Получаваме 011010.

\justify
Стъпка $h = 3$:
Сега имаме, че $A = 01$ и $B = 1010$. Оттук получаваме:
\begin{center}
    $A' = 1010$ \\
    $B' = A \oplus f_3(B) = 01 \oplus f_3(1010) = 01 \oplus 00 = 01$
\end{center}
Получаваме 101001.

\justify
Стъпка $h = 4$:
Сега имаме, че $A = 10$ и $B = 1001$. Оттук получаваме:
\begin{center}
    $A' = 1001$ \\
    $B' = A \oplus f_4(B) = 10 \oplus f_4(1001) = 10 \oplus 01 = 11$
\end{center}
Получаваме 100111, което и търсихме.

\section*{Задача 8}

\justify
Искаме да докажем, че броят на откритите текстове $m$, които се шифрират в себе си, т.е. за които $m^e \equiv m \mod n$. Имаме още, че модулът е $n = pq$ и, че шифриращат експонента е $e$. Също така $p$ и $q$ са две големи прости числа с дължина поне 512 бита. Тъй като са прости числа, то $gcd(p,q) = 1$. Имаме още, че $m$ е цяло число. Тогава от китайската теорема за остатъците имаме, че системата 

\begin{center}
    $m^e \equiv m \mod p$ \\
    $m^e \equiv m \mod q$
\end{center}

\justify
винаги има решение и всеки две решения се различават с кратно на $n$.


\justify
Първо ще покажем, че $m^e \equiv m \mod p$ има $1 + gcd(e-1,\varphi(p))$ решения по $\mod p$.

\justify
Нека $p \mid m$ и
\begin{center}
    $m^e \equiv m \mod p$
\end{center}
\justify
Тогава 
\begin{center}
    $m(m^{e-1}-1) \equiv 0 \mod p$
\end{center} 
\justify
и също така 
\begin{center}
    $m^{e-1} \not\equiv 1 \mod p$,
\end{center}
\justify
защото сме допуснали, че $p \mid m$ и значи $p \mid m^{e-1}$. От тук получаваме, че 
\begin{center}
    $m \equiv 0 \mod p$,
\end{center}
\justify
което е еквивалентно на допускането $p \mid m$.

\justify
Нека сега $p \nmid m$. Tогава 
\begin{center}
    $m \equiv g^t \mod p$,
\end{center}
\justify
където $g$ е примитивен корен по модул $p$, тоест $g^{p-1} \equiv 1 \mod p$ и $g^k \not\equiv 1 \mod p$, $k < p-1$. Следователно можем да решаваме сравнението спрямо $t$. Сега имаме, че 
\begin{center}
    $g^{te} \equiv g^t \mod p$
\end{center}
\justify
или еквивалентно
\begin{center}
    $g^{t(e-1)} \equiv 1 \mod p$
\end{center}
\justify
тогава и само тогава, когато 
\begin{center}
    $t(e-1) \equiv 0 \mod \varphi(p)$,
\end{center}
\justify
защото $g$ е примитивен корен. Последното има $gcd(e-1,\varphi(p))$ = $gcd(e-1,p-1)$ решения. Добавяйки и тривиалното решение, получаваме, че $m^e \equiv m \mod p$ има обшо $1 + gdc(e-1,p-1)$ решения.

\justify
По аналогичен начин получаваме, че $m^e \equiv m \mod q$ има $1 + gcd(e-1,q-1)$ решения. От китайската теорема за остатъци следва, че системата, а от там и броят на отркитите текстове, които се шифрират в себе си, е $(1 + gcd(e-1,p-1))(1 + gcd(e-1,q-1))$.

\section*{Задача 9}

\justify
Следният код на $Wolfram Mathematica$
\begin{verbatim}
    For[i = 1, i <= 101, i++,
        value = Mod[2^i, 101];
        If[value == 1, Print[i]];
    ]
\end{verbatim}
с изход 
\begin{verbatim}
    100
\end{verbatim}
показва, че 2 генерира $Z_{101}^*$. По същия начин 
\begin{verbatim}
    For[i = 1, i <= 101, i++,
        value = Mod[2^i, 101];
        If[value == 66, Print[i]];
    ]
\end{verbatim}
с изход 
\begin{verbatim}
    83
\end{verbatim}
получаваме, че отговърт е 83, но все пак ще приложим алгоритъма на $Pohlig-Hellman$.

\justify
В случая $q = 101$, $q-1 = 100 = 2^2.5^2$, $\alpha = 2$, $\alpha^{-1} = 51$. Търсим това $m$, за което 
\begin{center}
    $2^m = 66 \mod 101$.
\end{center}
Извъшваме пресмятанията
\begin{center}
    $\beta_1 = 2^{\frac{100}{2}} = 2^{50} = 100$ \\
    $\beta_2 = 2^{\frac{100}{5}} = 2^{20} = 95$
\end{center}

\begin{center}
$p_1 = 2$ 
    \begin{tabular}{c|c c}
        $i$ & 0 & 1 \\
        \hline
        $\beta_1^i$ & 1 & 100 \\
    \end{tabular} \\
$p_2 = 5$
    \begin{tabular}{c|c c c c c}
        $i$ & 0 & 1 & 2 & 3 & 4 \\
        \hline
        $\beta_1^i$ & 1 & 95 & 36 & 87 & 84 \\
    \end{tabular} \\
\end{center}
Нека $2^m \equiv c \mod 101$, където $c = 66$. Тогава 
\begin{center}
\begin{tabular}{c c c c}
 
 \shortstack{ \textcolor{white}{*} \\ $p_1 = 2, n_1 = 2$ \\ \textcolor{white}{*} } &
 \shortstack{$c = 66,$ \\ $c_1 = c\alpha^{-1} = 33,$ \\ $\implies m^{(1)} = 1 + 1.2^1 = 3$} & 
 \shortstack{$c^{\frac{100}{2}} = 100,$ \\ $c_1^{\frac{100}{2^2}} = 100$ \\ \textcolor{white}{*}} & 
 \shortstack{$\implies b_0 = 1$ \\ $\implies b_1 = 1$ \\ \textcolor{white}{*}} \\ 

\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{c c c c}
 
 \shortstack{ \textcolor{white}{*} \\ $p_2 = 5, n_2 = 2$ \\ \textcolor{white}{*} } &
 \shortstack{$c = 66,$ \\ $c_1 = c\alpha^{-3} = 84,$ \\ $\implies m^{(2)} = 3 + 1.5^1 = 8 $} & 
 \shortstack{$c^{\frac{100}{5}} = 87,$ \\ $c_1^{\frac{100}{5^2}} = 95$ \\ \textcolor{white}{*}} & 
 \shortstack{$\implies b_0 = 3$ \\ $\implies b_1 = 1$ \\ \textcolor{white}{*}} \\ 

\end{tabular}
\end{center}

\justify
Сега остава да пресметнем $m$.
\begin{center}
    $M_1 = \frac{100}{4} = 25$ и $y_1 \equiv M_1^{-1} \mod 4$, тоест $y_1 = 1$ \\
    $M_2 = \frac{100}{25} = 4$ и $y_2 \equiv M_2^{-1} \mod 25$, тоест $y_2 = 19$
\end{center}
За $m$ получаваме 
\begin{center}
    $m = 3.25.1 + 8.4.19 = 683$,
\end{center}
за което имаме $2^{683} \equiv 2^{83} \equiv 66 \mod 101$. Следователно $\log_266 = 83$ в $Z^*_{101}$.

\section*{Задача 10}

\justify
Нека $m$ е случайно число, такова че $0 < m < n$, и решаваме сравнението $x^2 \equiv m^2 \mod n$ във $F(n)$ стъпки с помощта на алгоритъма $A$. Нека $k$ е едно от четирите решения на $x^2 \equiv m^2 \mod n$. Всяка от следните възможности се реализира с вероятност $\frac{1}{4}$:
\begin{center}
    1) $k \equiv m \mod p$, $k \equiv m \mod q$ \\
    2) $k \equiv m \mod p$, $k \equiv -m \mod q$ \\
    3) $k \equiv -m \mod p$, $k \equiv m \mod q$ \\
    4) $k \equiv -m \mod p$, $k \equiv -m \mod q$
\end{center}
В случай $2)$ имаме $gcd(k-m,n) = p$, а в случай $3)$ - $gcd(k-m,n) = q$. Следователно пресмятането на $gcd(k-m,n)$ намира разлагането с вероятност $\frac{1}{2}$. Това пресмятане изисква $2\log n$ стъпки. Така при всеки избор за $m$ ще извършваме $F(n) + 2\log n$ стъпки като вероятността за успех е $\frac{1}{2}$. Очакваният брой опити до намиране на разлагането на $n$ е два, което е и твърдението на теоремата.

\section*{Задача 11}

\justify
Елементите на GF($2^{10}$) може да се представят като полиноми от степен по-малка от 10 над GF($2$). Тогава операциите се извършват по $\mod R$, където $R$ е неразложим полином от степен 10 над GF($2$). В нашата задача този полином е $x^{10}+x^3+1$. Умножението извършваме по стандартния начин и по $\mod 2$ и след това взимаме остатъка по $\mod R$, пак по $\mod 2$.
\justify
В задачата търсим общия ключ $k_{A,B} = C_B^{x_A} = (x + x^5 + x^7)^2$. Тоест имаме да извършим умножението $(x + x^5 + x^7)(x + x^5 + x^7)$:
\begin{center}
    $(x + x^5 + x^7)(x + x^5 + x^7) = x^2 + 2 x^6 + 2 x^8 + x^{10} + 2 x^{12} + x^{14}$,
\end{center}
което по $\mod 2$ е 
\begin{center}
    $x^2 + x^{10} + x^{14}$.
\end{center}
Сега остава да пресметнем остатъка при деление (накрая по $\mod 2$) на 
\begin{center}
     $x^2 + x^{10} + x^{14}$
\end{center}
с полинома
\begin{center}
    $x^{10}+x^3+1$.
\end{center}
За целта ще запишем полинома 
\begin{center}
    $x^{14}+ x^{10} + x^2$ във вида $100010000000100$
\end{center}
и 
\begin{center}
    $x^{10}+x^3+1$ във вида $10000001001$.
\end{center}
Ще използваме $long$ $notation$ по $\mod 10000001001$:
\begin{center}
    \begin{tabular}{c c c c c c c c c c c c c c c}
        \hline
        1&0&0&0&1&0&0&0&0&0&0&0&1&0&0 \\
        1&0&0&0&0&0&0&1&0&0&1& & & & \\
        \hline
        0&0&0&0&1&0&0&1&0&0&1&0&1&0&0 \\
         & & &*&1&0&0&0&0&0&0&1&0&0&1 \\
        \hline
         & & & &0&0&0&1&0&0&1&1&1&0&1    
    \end{tabular}
\end{center}
Така получихме, че общият ключ $k_{A,B}$ е 00010011101, тоест 
\begin{center}
    $k_{A,B} = x^7+x^4+x^3+x^2+1$.
\end{center}

\section*{Задача 12}

\justify
$\textit{Генериране на ключове в схемата на ElGamal:}$ 
\justify
1) По условие $p = 101$ и $\alpha = 2$ е пораждащ елемент на $Z_{101}^*$. \\
2) По условие $a = 43$ и наистина $1 \leq a \leq p-2=99$. \\
3) Пресмятаме $y = \alpha ^ a = 2^{43} \mod 101$. Получаваме, че $y = 86$. \\
4) Публичният ключ е тройката $(p,\alpha,y) = (101,2,86)$. Частен ключ е $a = 43$.

\justify
$\textit{Генериране на подписи в схемата на ElGamal:}$
\justify
1) Избираме случайното число $k = 23, 1 \leq k \leq p-2=99$, за което $gcd(k,p-1) = gcd(23,100) = 1$.\\
2) Пресмятаме $r = \alpha ^ k = 2 ^ {23} \mod 101$. Получаваме, че $ r = 53$.\\
3) Пресмятаме $s = k^{-1}(h(m) - ar) = 87(26-43.53) \mod 100$, като предварително за удобство сме избрали $h(m) = m$. Получаваме, че $s = 89$. \\
4) Подписът за $m$ е двойката $(r,s) = (53,89)$.

\justify
$\textit{Верифициране на подписи в схемата на ElGamal:}$
\justify
1) Получаваме публичния ключ $(p,\alpha,y) = (101,2,86)$. \\
2) Проверяваме дали $1 \leq r = 53 \leq p-1=100$, което очевидно е изпълнено и следователно не отхвърляме подписа. \\
3) Пресмятаме $u = y^r r^s = 86^{53} 53^{89} \mod 101$. Получаваме, че $u = 20$. \\
4) Пресмятаме $h(m) = m = 26$ и $v = \alpha ^ {h(m)} = 2 ^ {26} \mod 101$. Получаваме $v = 20$. \\ 
5) Приемаме подписа, защото $u = v$.

\section*{Задача 13}

\justify
Следният код на $Wolfram$ $Mathematica$ 
\begin{verbatim}
    For[i = 1, i <= 353, i++,
        value = Mod[3^i, 353];
        If[value == 1, Print[i]];
    ]
\end{verbatim}
с изход 
\begin{verbatim}
    352
\end{verbatim}
показва, че 3 генерира $Z^*_{353}$. По същия начин 
\begin{verbatim}
    For[i = 1, i <= 353, i++,
        value = Mod[3^i, 353];
        If[value == 135, Print[i]];
    ]
\end{verbatim}
с изход 
\begin{verbatim}
    312
\end{verbatim}
получаваме, че отговорът е 312, но все пак ще приложим алгоритъма $Baby$ $step/giant$ $step$.

\justify
Този код 
\begin{verbatim}
    n = 352;
    m = Ceiling[Sqrt[352]];
    alfa = 3;
    beta = 135;

    gama = beta;
    i = 1;
    While[gama != 3, 
        gama = Mod[gama*PowerMod[alfa, -m, 353], 353];
        For[j = 0, j <= m, j++,
            If[gama == Mod[alfa^j, 353], If[gama == 3, Print[i*m + j]]
            ]
        ];
    i++
    ]
\end{verbatim}
с изход 
\begin{verbatim}
    2072
\end{verbatim}
имплементира алгориътма и чрез него получаваме, че $x = 2072$, за което имаме $3^{2072} \equiv 3^{312} \equiv 135 \mod 353$. Следователно $\log_3135 = 312$ в $Z^*_{353}$.

\section*{Задача 14}

\justify
По условие имаме свръхнарастващ вектор 
$a = (2,3,7,13,27,53,106,213,425,851)$, модулът $m = 1529$ и $t = 64$. 
Трябва да шифрираме съобщението LONDON. Векторът $b$ получаваме чрез слабо умножение на $a$ с $t$ по модул $m$, защото $m \geq \max a = 851$. За $b$ получаваме
\begin{center}
    $b = (128, 192, 448, 832, 199, 334, 668, 1400, 1207, 949)$.
\end{center}
Сега ще шифрираме текста LONDON, позовавайки се на таблицата от условието
\begin{center}
    LO $\rightarrow$ 10001 10100 $\rightarrow$ $128+199+334+1400 = 2061$\\
    ND $\rightarrow$ 10011 00111 $\rightarrow$ $128+832+199+1400+1207+949 = 4715$ \\
    ON $\rightarrow$ 10100 10011 $\rightarrow$ $128+448+334+1207+949 = 3066$
\end{center}
Така криптотекстът е 
\begin{center}
    $2061$ $4715$ $3066$.
\end{center}

\section*{Задача 15}

\justify
(i) Искаме $3$ да дели $\varphi(n) = \varphi(pq) = \varphi(p).\varphi(q) = (p-1)(q-1)$. Това означава, че 3 дели или $p-1$, или $q-1$. Тоест или $p \equiv 1 \mod 3$, или $q \equiv 1 \mod 3$, или и $p \equiv 1 \mod 2$ и $q \equiv 1 \mod 3$. 

\justify
(ii) Ако $g$ генерира $Z_p^*$, където (по условие) $p$ е нечетно просто число. Кубичен корен можем да запишем като
\begin{center}
    $g^{3i} \equiv g^j \mod p$,
\end{center}
където $i$ и $j$ са цели числа. Това е еквивалентно на 
\begin{center}
    $3i \equiv j \mod (p-1)$.
\end{center}
Тъй като 3 е просто число, то $gcd(p-1,3) = 1$ или $gcd(p-1,3) = 3.$ Ако $gcd(p-1,3) = 3$, то от $\textit{Теорема 7.8}$ от $\textit{Лекция 7}$ имаме, че  $3i \equiv j \mod (p-1)$ има 3 решения. Ако $gcd(p-1,3) = 1$, то от $\textit{Следствие 7.9}$ от $\textit{Лекция 7}$ имаме, че  $3i \equiv j \mod (p-1)$ има точно едно решение.

\justify
В случая, когато $p \equiv 1 \mod 3$, то $gcd(p-1,3) = 3$, тоест $y^3 \equiv x \mod p$ има 3 решения. И също така $q \equiv 2 \mod 3$, то $gcd(q-1,3) = 1$, тоест $y^3 \equiv x \mod q$ има едно решение. Сега от \textit{Китайската теорема за остатъците} получаваме, че $y^3 \equiv x \mod n$ има 3.1 = 3 решения.

\justify
В случая, когато $p \equiv q \equiv 1 \mod 3$, имаме, че $gcd(p-1,3) = 3$ и  $gcd(q-1,3) = 3$, тоест $y^3 \equiv x \mod p$ има 3 решения и $y^3 \equiv x \mod q$ има също 3 решения. От \textit{Китайската теорема за остатъците} получаваме, че $y^3 \equiv x \mod n$ има 3.3 = 9 решения.

\justify
Сега по условие имаме два различни кубични корена $y$ и $z$ на даде елемент $x$ от $C_n$. Тогава е изпълнено 
\begin{center}
    $y^3 \equiv x^3 \equiv x \mod n$.
\end{center}

\end{document}





















































